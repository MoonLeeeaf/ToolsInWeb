<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Bilibili è§†é¢‘åˆ†äº«</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://www.unpkg.com/jquery@3.7.1/dist/jquery.min.js"></script>
        <style>
             iframe.player {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }
        </style>
        <link rel="icon" href="https://www.bilibili.com/favicon.ico?v=1" />
    </head>
    <body>
        <iframe class="player" frameborder="0"></iframe>
        <script>
            let param = new URL(location.href).searchParams
            let url = param.get("url")
            if (!url) url = ""
        
            // æ­»ğŸ´è·¨åŸŸ å®³å¾—æˆ‘æ²¡æ³•æ–½å±•é»‘é­”æ³•
            // ç”µè„‘ç«¯ç›´æ¥å»çœ‹å§ï¼Œç§»åŠ¨ç«¯çš„ç½‘é¡µç«¯ä½“éªŒæ›´å·®ï¼Œç”µè„‘ç«¯çš„å¤–é“¾å¾ˆåƒåœ¾
            if (!/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent))
                if (url.trim() != "")
                    location.replace(url.startsWith("http") ? url : "https://www.bilibili.com/video/" + url)
                else {
                    alert("ç”µè„‘ç«¯çš„ä½“éªŒå¾ˆåƒåœ¾ï¼Œå› æ­¤å·²ç»é˜»æ–­äº†è®¿é—®ï¼Œå¦å¤–ä½ çš„å‚æ•°æ²¡æœ‰ url=xxxï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•äº‹ã€‚\n\nè¯·å…³é—­æ­¤é¡µé¢ï¼Œè¿™æ˜¯ä¸ªå¤±æ•ˆçš„é¡µé¢ã€‚")
                    location.replace("about:blank")
                }
        
            /*function setUserAgent(window, userAgent) {
                if (window.navigator.userAgent != userAgent) {
                    let userAgentProp = { get: function () { return userAgent; } };
                    try {
                        Object.defineProperty(window.navigator, 'userAgent', userAgentProp);
                    } catch (e) {
                        window.navigator = Object.create(navigator, {
                            userAgent: userAgentProp
                        })
                    }
                }
            }*/
            
            let base = "https://player.bilibili.com/player.html?"
            
            let i = url.toLowerCase().indexOf("bv") !== -1
            if (i)
                url = base + "bvid=" + url.substring(i, 114514)
            
            i = url.toLowerCase().indexOf("av") !== -1
            if (i)
                url = base + "avid=" + url.substring(i, 114514)
            
            if (url.trim() == "") {
                alert("æ‰¾ä¸åˆ°è§†é¢‘ï¼ æœ¬ç½‘é¡µçš„è°ƒç”¨æ ¼å¼: [åŸæ–‡ä»¶åœ°å€]?url=[è§†é¢‘åœ°å€/BVå·/AVå·]\n\nä¾‹: " + location.href + "?url=BV19C411t7C9\n\næ¥ä¸‹æ¥å°†æ’­æ”¾ç¤ºèŒƒè§†é¢‘")
                url = base + "bvid=BV19C411t7C9"
            }
             
            let p = $("iframe.player")
            // setUserAgent(p.get(0).contentWindow, "Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.91 Mobile Safari/537.36")
            p.attr("src", url)
        </script>
    </body>
</html>
